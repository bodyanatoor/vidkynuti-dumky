<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–í—ñ–¥–∫–∏–Ω—É—Ç—ñ –¥—É–º–∫–∏</title>
  <meta name="description" content="–ê—Ä—Ö—ñ–≤ –¥—É–º–æ–∫, —è–∫—ñ –Ω–µ –ø—Ä–æ–π—à–ª–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Ü–µ–Ω–∑—É—Ä—É. –ñ–∏–≤–∏–π –ø—Ä–æ—Ü–µ—Å –≤—ñ–¥–∫–∏–¥–∞–Ω–Ω—è —ñ–¥–µ–π.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üóíÔ∏è</text></svg>">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
      background:#000;color:#fff;min-height:100vh;
      display:flex;flex-direction:column;align-items:center;
      padding:40px 20px;overflow:auto;
    }
    .title{
      font-size:clamp(32px,8vw,72px);font-weight:900;letter-spacing:.02em;
      margin-bottom:60px;text-align:center;z-index:100;position:relative;
    }
    .sticky-stack{
      width:100%;max-width:400px;height:400px;position:relative;
      margin-bottom:60px;
    }
    .sticky-note{
      position:absolute;width:100%;height:100%;
      background:linear-gradient(135deg,#FFE87C 0%,#FFD952 100%);
      box-shadow:0 10px 30px rgba(0,0,0,.3), inset 0 -2px 10px rgba(0,0,0,.05);
      cursor:pointer;transition:transform .2s, box-shadow .2s;
      display:flex;align-items:center;justify-content:center;padding:50px 40px;
    }
    .sticky-note::before{
      content:'';position:absolute;top:0;left:0;right:0;height:20px;
      background:linear-gradient(to bottom,rgba(0,0,0,.08),transparent);
    }
    .sticky-note:nth-child(1){z-index:10;transform:rotate(0deg)}
    .sticky-note:nth-child(2){z-index:9; transform:rotate(-1deg) translateY(3px);  opacity:.95}
    .sticky-note:nth-child(3){z-index:8; transform:rotate(1deg)  translateY(6px);  opacity:.9}
    .sticky-note:nth-child(4){z-index:7; transform:rotate(-.5deg) translateY(9px);  opacity:.85}
    .sticky-note:nth-child(5){z-index:6; transform:rotate(.8deg)  translateY(12px); opacity:.8}

    .sticky-note:hover{
      transform:rotate(0deg) translateY(-5px) !important;
      box-shadow:0 15px 40px rgba(0,0,0,.4), inset 0 -2px 10px rgba(0,0,0,.05);
      z-index:50 !important;
    }

    .sticky-note.peeling-right{animation:peelRight 1.2s cubic-bezier(.34,1.56,.64,1) forwards}
    .sticky-note.peeling-left{ animation:peelLeft  1.2s cubic-bezier(.34,1.56,.64,1) forwards}
    .sticky-note.peeling-up{   animation:peelUp    1s   cubic-bezier(.34,1.56,.64,1) forwards}

    @keyframes peelRight{
      0%{transform:rotate(0) translate(0,0) scale(1);opacity:1}
      100%{transform:rotate(-35deg) translate(400px,-600px) scale(.3);opacity:0}
    }
    @keyframes peelLeft{
      0%{transform:rotate(0) translate(0,0) scale(1);opacity:1}
      100%{transform:rotate(35deg) translate(-400px,-600px) scale(.3);opacity:0}
    }
    @keyframes peelUp{
      0%{transform:rotate(0) translate(0,0) scale(1);opacity:1}
      100%{transform:rotate(15deg) translate(-50px,-700px) scale(.2);opacity:0}
    }

    .sticky-text{
      font-family:'Courier New',monospace;
      font-size:clamp(16px,3vw,22px);line-height:1.5;color:#1a1a1a;
      text-align:center;max-width:100%;word-wrap:break-word;
    }

    .form-section{width:100%;max-width:640px;text-align:center;z-index:100;position:relative}
    .form-title{font-size:clamp(18px,3vw,28px);font-weight:400;margin-bottom:30px}
    textarea{
      width:100%;min-height:160px;padding:20px;
      font-family:'Courier New',monospace;font-size:16px;line-height:1.6;
      background:#000;color:#fff;border:2px solid #fff;resize:vertical;transition:border-color .3s;
      position:relative;z-index:1;
    }
    textarea:focus{outline:none;border-color:#FFD952}
    textarea::placeholder{color:#666}

    .submit-btn{
      margin-top:20px;padding:15px 40px;font-family:inherit;font-size:16px;
      background:#FFD952;color:#000;border:none;cursor:pointer;transition:all .3s;
      text-transform:uppercase;letter-spacing:.05em;font-weight:600;
      position:relative;z-index:1000;
    }
    .submit-btn:hover{background:#FFE87C;transform:translateY(-2px);box-shadow:0 5px 15px rgba(255,217,82,.4)}
    .submit-btn:disabled{opacity:.5;cursor:not-allowed;transform:none}

    .message{margin-top:20px;font-size:14px;opacity:0;transition:opacity .3s}
    .message.visible{opacity:.7}

    /* === –ù–ò–ñ–ù–Ü–ô –¢–ï–ö–°–¢-–õ–Ü–ù–ö === */
    .contact-link{
      position:fixed;
      bottom:30px;
      right:30px;
      font-size:14px;
      opacity:.6;
      color:#fff;
      text-decoration:none;
      transition:opacity .3s;
    }
    .contact-link:hover{opacity:1;text-decoration:underline;color:#FFD952}

    @media (max-width:768px){
      .contact-link{bottom:20px;right:20px;font-size:12px}
    }
  </style>
</head>
<body>
  <h1 class="title">–í–Ü–î–ö–ò–ù–£–¢–Ü –î–£–ú–ö–ò</h1>
  <div class="sticky-stack" id="stickyStack"></div>

  <div class="form-section">
    <h2 class="form-title">–Ø–∫—É –¥—É–º–∫—É –≤–∏ –≤—ñ–¥–∫–∏–Ω—É–ª–∏?</h2>
    <textarea id="thoughtInput" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å —Ç–µ, —â–æ –Ω–µ –≤—Å—Ç–∏–≥–ª–æ —Å—Ç–∞—Ç–∏..." maxlength="300"></textarea>
    <button class="submit-btn" id="submitBtn" type="button">–í—ñ–¥–∫–∏–Ω—É—Ç–∏ ‚Üí</button>
    <div class="message" id="message"></div>
  </div>

  <!-- –ù–æ–≤–∏–π –±–ª–æ–∫ ‚Äî –∑–∞–º—ñ—Å—Ç—å –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ -->
  <a href="https://t.me/bodyanatoor" target="_blank" class="contact-link">
    –î–ª—è –∫–æ–Ω—Ç–∞–∫—Ç—É –∑ –∞–≤—Ç–æ—Ä–æ–º –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å —Å—é–¥–∏
  </a>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    let db = null;
    try { db = getFirestore(initializeApp(firebaseConfig)); } 
    catch { console.log("Firebase not configured ‚Äî running locally"); }

    const stack = document.getElementById('stickyStack');
    const input = document.getElementById('thoughtInput');
    const submitBtn = document.getElementById('submitBtn');
    const message = document.getElementById('message');

    const initialThoughts = [
      '"–ó–∞—Å–ø–æ–∫–æ—ó—Ç–∏ —Å–≤–æ–≥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –¥–æ—Å—è–≥–∞—á–∞"',
      '"—á–æ–º—É —è –≤–∑–∞–≥–∞–ª—ñ —Ä–æ–±–ª—é"',
      '"—Ç–∏ –æ–±–∏—Ä–∞—î—à –∫–æ–≥–æ –ª—é–±–∏—Ç–∏ —ñ"',
      '"–ü–∏—Å–∞—Ç–∏ –¥—É–º–∫–∏ –≤ —Ç–≥ —Ü–µ –Ω–µ..."',
      '"–Ü–Ω–æ–¥—ñ –º–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è, —â–æ —è –ø—Ä–æ—Å—Ç–æ..."'
    ];

    let thoughts = [...initialThoughts];
    let order = [];
    let currentIndex = 0;

    function reshuffle(){
      order = thoughts.map((_, i)=>i);
      for(let i=order.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [order[i],order[j]]=[order[j],order[i]];
      }
      currentIndex=0;
    }

    async function loadThoughts(){
      if(!db) return;
      try{
        const q=query(collection(db,'thoughts'),orderBy('timestamp','desc'),limit(20));
        const snap=await getDocs(q);
        snap.forEach(d=>{
          const t=d.data().text;
          if(t && !thoughts.includes(t)) thoughts.push(t);
        });
      }catch{}
    }

    function createStickies(){
      stack.innerHTML='';
      const total=order.length||thoughts.length;
      for(let i=0;i<5&&i<total;i++){
        const oi=(currentIndex+i)%total;
        const ti=order.length?order[oi]:oi;
        const sticky=document.createElement('div');
        sticky.className='sticky-note';
        sticky.innerHTML=`<div class="sticky-text">${thoughts[ti]}</div>`;
        if(i===0) sticky.addEventListener('click',peelSticky);
        stack.appendChild(sticky);
      }
    }

    function peelSticky(){
      const s=stack.querySelector('.sticky-note:first-child');
      if(!s) return;
      const dirs=['peeling-right','peeling-left','peeling-up'];
      s.classList.add(dirs[Math.floor(Math.random()*dirs.length)]);
      s.style.pointerEvents='none';
      setTimeout(()=>{
        const total=order.length||thoughts.length;
        currentIndex=(currentIndex+1)%total;
        createStickies();
      },1200);
    }

    function showMessage(t){
      message.textContent=t;
      message.classList.add('visible');
      setTimeout(()=>message.classList.remove('visible'),3000);
    }

    function isSpam(text){
      return [/https?:\/\//i,/www\./i,/@[\w]+/i,/(buy|sale|discount)/i].some(r=>r.test(text));
    }

    submitBtn.addEventListener('click',async()=>{
      const raw=input.value.trim();
      if(raw.length<5){showMessage('–î—É–º–∫–∞ –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∞...');return;}
      if(isSpam(raw)){showMessage('–°—Ö–æ–∂–µ –Ω–∞ —Å–ø–∞–º.');return;}
      const wrapped=`"${raw}"`;
      try{
        if(db) await addDoc(collection(db,'thoughts'),{text:wrapped,timestamp:new Date()});
        thoughts.push(wrapped);
        reshuffle();createStickies();
        input.value='';showMessage('–î–æ–¥–∞–Ω–æ!');
      }catch(e){showMessage('–ü–æ–º–∏–ª–∫–∞, –∞–ª–µ –¥—É–º–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ.')}
    });

    document.addEventListener('keydown',e=>{
      if((e.key===' '||e.key==='Enter')&&document.activeElement!==input)peelSticky();
    });

    (async()=>{await loadThoughts();reshuffle();createStickies();})();
  </script>
</body>
</html>
