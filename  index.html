<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—ñ–¥–∫–∏–Ω—É—Ç—ñ –¥—É–º–∫–∏</title>
    <meta name="description" content="–ê—Ä—Ö—ñ–≤ –¥—É–º–æ–∫, —è–∫—ñ –Ω–µ –ø—Ä–æ–π—à–ª–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Ü–µ–Ω–∑—É—Ä—É. –ñ–∏–≤–∏–π –ø—Ä–æ—Ü–µ—Å –≤—ñ–¥–∫–∏–¥–∞–Ω–Ω—è —ñ–¥–µ–π.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üóíÔ∏è</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            overflow: hidden;
        }

        .title {
            font-size: clamp(32px, 8vw, 72px);
            font-weight: 900;
            letter-spacing: 0.02em;
            margin-bottom: 60px;
            text-align: center;
            z-index: 100;
            position: relative;
        }

        .sticky-stack {
            width: 100%;
            max-width: 400px;
            height: 400px;
            position: relative;
            margin-bottom: 60px;
        }

        .sticky-note {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FFE87C 0%, #FFD952 100%);
            box-shadow: 
                0 10px 30px rgba(0,0,0,0.3),
                inset 0 -2px 10px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px 40px;
        }

        .sticky-note::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.08), transparent);
        }

        .sticky-note:nth-child(1) {
            z-index: 10;
            transform: rotate(0deg);
        }

        .sticky-note:nth-child(2) {
            z-index: 9;
            transform: rotate(-1deg) translateY(3px);
            opacity: 0.95;
        }

        .sticky-note:nth-child(3) {
            z-index: 8;
            transform: rotate(1deg) translateY(6px);
            opacity: 0.9;
        }

        .sticky-note:nth-child(4) {
            z-index: 7;
            transform: rotate(-0.5deg) translateY(9px);
            opacity: 0.85;
        }

        .sticky-note:nth-child(5) {
            z-index: 6;
            transform: rotate(0.8deg) translateY(12px);
            opacity: 0.8;
        }

        .sticky-note:hover {
            transform: rotate(0deg) translateY(-5px) !important;
            box-shadow: 
                0 15px 40px rgba(0,0,0,0.4),
                inset 0 -2px 10px rgba(0,0,0,0.05);
            z-index: 50 !important;
        }

        .sticky-note.peeling-right {
            animation: peelRight 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .sticky-note.peeling-left {
            animation: peelLeft 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .sticky-note.peeling-up {
            animation: peelUp 1s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        @keyframes peelRight {
            0% { transform: rotate(0deg) translate(0, 0) scale(1); opacity: 1; }
            20% { transform: rotate(-8deg) translate(10px, -30px) scale(1.05); }
            50% { transform: rotate(-15deg) translate(150px, -200px) scale(0.9); }
            70% { transform: rotate(-25deg) translate(280px, -350px) scale(0.7); opacity: 0.8; }
            100% { transform: rotate(-35deg) translate(400px, -600px) scale(0.3); opacity: 0; }
        }

        @keyframes peelLeft {
            0% { transform: rotate(0deg) translate(0, 0) scale(1); opacity: 1; }
            20% { transform: rotate(8deg) translate(-10px, -30px) scale(1.05); }
            50% { transform: rotate(15deg) translate(-150px, -200px) scale(0.9); }
            70% { transform: rotate(25deg) translate(-280px, -350px) scale(0.7); opacity: 0.8; }
            100% { transform: rotate(35deg) translate(-400px, -600px) scale(0.3); opacity: 0; }
        }

        @keyframes peelUp {
            0% { transform: rotate(0deg) translate(0, 0) scale(1); opacity: 1; }
            20% { transform: rotate(-3deg) translate(5px, -40px) scale(1.08); }
            50% { transform: rotate(5deg) translate(-20px, -250px) scale(0.85); }
            70% { transform: rotate(-10deg) translate(30px, -450px) scale(0.6); opacity: 0.7; }
            100% { transform: rotate(15deg) translate(-50px, -700px) scale(0.2); opacity: 0; }
        }

        .sticky-text {
            font-family: 'Courier New', monospace;
            font-size: clamp(16px, 3vw, 22px);
            line-height: 1.5;
            color: #1a1a1a;
            text-align: center;
            max-width: 100%;
            word-wrap: break-word;
        }

        .form-section {
            width: 100%;
            max-width: 640px;
            text-align: center;
            z-index: 100;
            position: relative;
        }

        .form-title {
            font-size: clamp(18px, 3vw, 28px);
            font-weight: 400;
            margin-bottom: 30px;
        }

        textarea {
            width: 100%;
            min-height: 160px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            line-height: 1.6;
            background: #000000;
            color: #ffffff;
            border: 2px solid #ffffff;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #FFD952;
        }

        textarea::placeholder {
            color: #666666;
        }

        .submit-btn {
            margin-top: 20px;
            padding: 15px 40px;
            font-family: inherit;
            font-size: 16px;
            background: #FFD952;
            color: #000000;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .submit-btn:hover {
            background: #FFE87C;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 217, 82, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            margin-top: 20px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .message.visible {
            opacity: 0.7;
        }

        .counter {
            position: fixed;
            bottom: 30px;
            right: 30px;
            font-size: 14px;
            opacity: 0.5;
            z-index: 100;
        }

        @media (max-width: 768px) {
            body { padding: 20px 15px; }
            .title { margin-bottom: 40px; }
            .sticky-stack { max-width: 320px; height: 320px; margin-bottom: 40px; }
            .sticky-note { padding: 40px 30px; }
            textarea { min-height: 120px; font-size: 14px; }
            .counter { bottom: 20px; right: 20px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <h1 class="title">–í–Ü–î–ö–ò–ù–£–¢–Ü –î–£–ú–ö–ò</h1>
    <div class="sticky-stack" id="stickyStack"></div>
    <div class="form-section">
        <h2 class="form-title">–Ø–∫—É –¥—É–º–∫—É –≤–∏ –≤—ñ–¥–∫–∏–Ω—É–ª–∏?</h2>
        <textarea id="thoughtInput" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å —Ç–µ, —â–æ –Ω–µ –≤—Å—Ç–∏–≥–ª–æ —Å—Ç–∞—Ç–∏..." maxlength="300"></textarea>
        <button class="submit-btn" id="submitBtn">–í—ñ–¥–∫–∏–Ω—É—Ç–∏ ‚Üí</button>
        <div class="message" id="message"></div>
    </div>
    <div class="counter" id="counter"></div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase config - –ó–ê–ú–Ü–ù–Ü–¢–¨ –ù–ê –°–í–û–Æ
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const initialThoughts = [
            '"–ó–∞—Å–ø–æ–∫–æ—ó—Ç–∏ —Å–≤–æ–≥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –¥–æ—Å—è–≥–∞—á–∞"',
            '"—á–æ–º—É —è –≤–∑–∞–≥–∞–ª—ñ —Ä–æ–±–ª—é"',
            '"—Ç–∏ –æ–±–∏—Ä–∞—î—à –∫–æ–≥–æ –ª—é–±–∏—Ç–∏ —ñ"',
            '"–ü–∏—Å–∞—Ç–∏ –¥—É–º–∫–∏ –≤ —Ç–≥ —Ü–µ –Ω–µ..."',
            '"–Ü–Ω–æ–¥—ñ –º–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è, —â–æ —è –ø—Ä–æ—Å—Ç–æ..."',
            '"–Ø —Ö–æ—Ç—ñ–≤ –Ω–∞–ø–∏—Å–∞—Ç–∏ –ø—Ä–æ —Å–µ–Ω—Å–∏, –∞–ª–µ –≤–∏–π—à–ª–æ –ø—Ä–æ..."',
            '"–ú–µ–Ω–µ –ª—è–∫–∞—î, —è–∫ –ª–µ–≥–∫–æ –º–∏..."',
            '"–Ø –ø–æ—Å—Ç—ñ–π–Ω–æ –ø–æ—á–∏–Ω–∞—é, –∞–ª–µ –Ω–µ..."',
            '"–ú–∞–±—É—Ç—å, –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ —Ç–æ–º—É, —â–æ —è..."',
            '"–ö–æ–∂–µ–Ω —Ä–∞–∑, –∫–æ–ª–∏ —è –≤—ñ–¥—á—É–≤–∞—é –Ω–∞—Ç—Ö–Ω–µ–Ω–Ω—è, –∑–¥–∞—î—Ç—å—Å—è..."',
            '"...–∂–æ–¥–Ω–∞ –∑ –Ω–∏—Ö –Ω–µ –≤–ª–∞—à—Ç–æ–≤—É—î –º–µ–Ω–µ –¥–æ –∫—ñ–Ω—Ü—è."',
            '"–ù–∞—Å–ø—Ä–∞–≤–¥—ñ –º–∏ –ª—é–±–∏–º–æ —Å–ª—É—Ö–∞—Ç–∏ —Ñ–∞–∫–∞–ø–∏ —ñ–Ω—à–∏—Ö..."',
            '"–õ—é–¥–∏–Ω—ñ, —è–∫—ñ–π –≤–ª–∞—Å—Ç–∏–≤–æ –±—É—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—é, –Ω—ñ–∫–æ–ª–∏ –Ω–µ..."',
            '"–í –∫–æ–∂–Ω–æ–º—É —É—Å–ø—ñ—Ö—É —î —Ç—Ä–æ—Ö–∏ –±—Ä–µ—Ö–Ω—ñ, —è–∫—É –º–∏..."',
            '"–ë–∞–ª–∞–¥–∞ –ø—Ä–æ –¥—É—Ö—ñ–≤ –ª—ñ—Å—É..."',
            '"–ú–æ–∂–µ, —è –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥—Ç–æ —Å–µ—Ä–π–æ–∑–Ω–æ —Å—Ç–∞–≤–ª—é—Å—å..."',
            '"–ö–æ–ª–∏ —è –ø–æ—á–∏–Ω–∞—é —Å—É–º–Ω—ñ–≤–∞—Ç–∏—Å—è, —Ü–µ –∑–∞–∑–≤–∏—á–∞–π –æ–∑–Ω–∞—á–∞—î..."',
            '"–Ü–Ω–æ–¥—ñ —è –¥—É–º–∞—é, —â–æ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞ ‚Äî —Ü–µ –ø—Ä–æ—Å—Ç–æ —Ñ–æ—Ä–º–∞..."',
            '"–º–æ–∂–ª–∏–≤–æ –º–µ–Ω—ñ –≤–∞—Ä—Ç–æ"',
            '"—è–∫–±–∏ —è –º—ñ–≥ –ø–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É"',
            '"—á–∏ —Å–ø—Ä–∞–≤–¥—ñ —Ü–µ –º–∞—î —Å–µ–Ω—Å"',
            '"—ñ–Ω–æ–¥—ñ —è –ª–æ–≤–ª—é —Å–µ–±–µ –Ω–∞ –¥—É–º—Ü—ñ —â–æ"',
            '"–º–æ–∂–ª–∏–≤–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º—É —â–æ —è"',
            '"—è –Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π —â–æ"',
            '"–∑–¥–∞—î—Ç—å—Å—è —è –∑–Ω–æ–≤—É"',
            '"–∫–æ–∂–µ–Ω —Ä–∞–∑ –∫–æ–ª–∏ —è –¥—É–º–∞—é –ø—Ä–æ —Ü–µ"',
            '"–º–∞–±—É—Ç—å —Ü–µ –≤—Å–µ –ø—Ä–æ —Ç–µ —â–æ"',
            '"—è –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–º–æ–∂—É"',
            '"—á–æ–º—É —ñ–Ω—à—ñ –º–æ–∂—É—Ç—å –∞ —è"',
            '"—è–∫—â–æ –ø–æ–¥—É–º–∞—Ç–∏ —Ç–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ"',
            '"—è –∑–∞–≤–∂–¥–∏ —Ö–æ—Ç—ñ–≤ —Å–∫–∞–∑–∞—Ç–∏ —â–æ"',
            '"–º–æ–∂–ª–∏–≤–æ —Ü–µ –∑–≤—É—á–∏—Ç—å –¥–∏–≤–Ω–æ –∞–ª–µ"',
            '"—ñ–Ω–æ–¥—ñ –º–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è —â–æ –Ω—ñ—Ö—Ç–æ –Ω–µ"',
            '"—è –Ω–µ –∑–Ω–∞—é —è–∫ —Ü–µ –ø–æ—è—Å–Ω–∏—Ç–∏"',
            '"–º–æ–∂–ª–∏–≤–æ —è —î–¥–∏–Ω–∏–π —Ö—Ç–æ"',
            '"—á–æ–º—É —Ç–∞–∫ –≤–∞–∂–∫–æ –ø—Ä–æ—Å—Ç–æ"',
            '"—è –¥—É–º–∞–≤ —â–æ —Ü–µ –±—É–¥–µ —ñ–Ω–∞–∫—à–µ"',
            '"–º–∞–±—É—Ç—å —è –Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –¥—É–º–∞—é –ø—Ä–æ"',
            '"–∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É –∫–æ–ª–∏ —è –Ω–∞–º–∞–≥–∞—é—Å—å"',
            '"–º–æ–∂–ª–∏–≤–æ —Ü–µ –Ω–µ —Ç–µ —â–æ"',
            '"—è –Ω–µ –º–æ–∂—É –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —á–æ–º—É"',
            '"–∑–¥–∞—î—Ç—å—Å—è –≤—Å–µ —â–æ —è —Ä–æ–±–ª—é"',
            '"–º–æ–∂–ª–∏–≤–æ –º–µ–Ω—ñ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–±–∞"',
            '"—è –∑–∞–≤–∂–¥–∏ –≤—ñ–¥–∫–ª–∞–¥–∞—é —Ü–µ —Ç–æ–º—É —â–æ"',
            '"—á–∏ –≤–∞—Ä—Ç–æ –≤–∑–∞–≥–∞–ª—ñ –Ω–∞–º–∞–≥–∞—Ç–∏—Å—å —è–∫—â–æ"',
            '"—ñ–Ω–æ–¥—ñ —è –≤—ñ–¥—á—É–≤–∞—é —â–æ"',
            '"–º–æ–∂–ª–∏–≤–æ —Ü–µ –∑–≤—É—á–∏—Ç—å –µ–≥–æ—ó—Å—Ç–∏—á–Ω–æ –∞–ª–µ"',
            '"—è –Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π —á–∏ —Ö–æ—á—É"',
            '"–∫–æ–∂–µ–Ω –¥–µ–Ω—å —è –æ–±—ñ—Ü—è—é —Å–æ–±—ñ —â–æ"',
            '"–º–∞–±—É—Ç—å —è –±–æ—é—Å—å —Ç–æ–≥–æ —â–æ"',
            '"—á–æ–º—É —è –Ω–µ –º–æ–∂—É –ø—Ä–æ—Å—Ç–æ"',
            '"–º–æ–∂–ª–∏–≤–æ –∫–æ–ª–∏—Å—å —è –∑—Ä–æ–∑—É–º—ñ—é"',
            '"—è –Ω–∞–º–∞–≥–∞–≤—Å—è –ø–æ—è—Å–Ω–∏—Ç–∏ –∞–ª–µ"',
            '"–∑–¥–∞—î—Ç—å—Å—è —â–æ –≤—Å—ñ –Ω–∞–≤–∫–æ–ª–æ"',
            '"–º–æ–∂–ª–∏–≤–æ —è –∑–∞–Ω–∞–¥—Ç–æ"',
            '"—è —Ö–æ—Ç—ñ–≤ –±–∏ –≤—ñ—Ä–∏—Ç–∏ —â–æ"',
            '"—á–æ–º—É —Ç–∞–∫ —Å–∫–ª–∞–¥–Ω–æ –±—É—Ç–∏"',
            '"—ñ–Ω–æ–¥—ñ —è –¥—É–º–∞—é —â–æ –∂–∏—Ç—Ç—è —Ü–µ"',
            '"–º–æ–∂–ª–∏–≤–æ —Å–ø—Ä–∞–≤–∂–Ω—è –º—É–¥—Ä—ñ—Å—Ç—å —É —Ç–æ–º—É —â–æ–±"',
            '"—è –Ω–µ –∑–Ω–∞—é –∑ —á–æ–≥–æ –ø–æ—á–∞—Ç–∏"',
            '"–∫–æ–∂–µ–Ω —Ä–∞–∑ –∫–æ–ª–∏ —è –¥–∏–≤–ª—é—Å—å –Ω–∞"',
            '"–º–æ–∂–ª–∏–≤–æ —â–∞—Å—Ç—è —Ü–µ –∫–æ–ª–∏"',
            '"—è –±–æ—é—Å—å —â–æ –Ω—ñ–∫–æ–ª–∏ –Ω–µ"',
            '"—á–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —â–æ –º–µ–Ω–µ"',
            '"—ñ–Ω–æ–¥—ñ —è –ª–æ–≤–ª—é —Å–µ–±–µ –Ω–∞ —Ç–æ–º—É —â–æ –ø—Ä–æ—Å—Ç–æ"',
            '"–º–æ–∂–ª–∏–≤–æ –Ω–∞–π—Å—Ç—Ä–∞—à–Ω—ñ—à–µ —Ü–µ"',
            '"—è –Ω–µ —Ä–æ–∑—É–º—ñ—é –Ω–∞–≤—ñ—â–æ"',
            '"–∑–¥–∞—î—Ç—å—Å—è —â–æ —á–∞—Å"',
            '"–º–æ–∂–ª–∏–≤–æ —è –ø–æ–º–∏–ª—è—é—Å—å –∞–ª–µ –º–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è —â–æ"',
            '"—á–æ–º—É –∫–æ–∂–µ–Ω —Ä–∞–∑ –∫–æ–ª–∏ —è"',
            '"—è —Ö–æ—Ç—ñ–≤ –±–∏ —Å–∫–∞–∑–∞—Ç–∏ —â–æ –≤–∞–∂–ª–∏–≤–æ"',
            '"—ñ–Ω–æ–¥—ñ –Ω–∞–π–≤–∞–∂—á–µ —Ü–µ"',
            '"–º–æ–∂–ª–∏–≤–æ —Å–ø—Ä–∞–≤–∂–Ω—è —Å–≤–æ–±–æ–¥–∞ —Ü–µ"',
            '"—è –Ω–µ –∑–Ω–∞—é —á–∏ –≥–æ—Ç–æ–≤–∏–π –¥–æ"',
            '"–∫–æ–∂–Ω–æ–≥–æ –≤–µ—á–æ—Ä–∞ —è –¥—É–º–∞—é –ø—Ä–æ —Ç–µ —è–∫"',
            '"–º–æ–∂–ª–∏–≤–æ —Ü–µ –ø—Ä–æ–∑–≤—É—á–∏—Ç—å –±–∞–Ω–∞–ª—å–Ω–æ –∞–ª–µ"',
            '"—è –∑–∞–≤–∂–¥–∏ –º—Ä—ñ—è–≤ –ø—Ä–æ —Ç–µ —â–æ–±"',
            '"—á–∏ –≤–∞—Ä—Ç–æ –±–æ—Ä–æ—Ç–∏—Å—å –∑–∞ —Ç–µ —â–æ"',
            '"—ñ–Ω–æ–¥—ñ –º–µ–Ω—ñ –∑–¥–∞—î—Ç—å—Å—è —â–æ –≤—Å—ñ –º–æ—ó —Å–ø—Ä–æ–±–∏"',
            '"–º–æ–∂–ª–∏–≤–æ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ —Ü–µ –Ω–µ"',
            '"—è –Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π —â–æ —Ö–æ—á—É –∑–Ω–∞—Ç–∏"',
            '"–∑–¥–∞—î—Ç—å—Å—è —â–æ —á–∏–º –±—ñ–ª—å—à–µ —è –¥—ñ–∑–Ω–∞—é—Å—å"',
            '"–º–æ–∂–ª–∏–≤–æ —Å–∞–º–µ –≤ —Ü—å–æ–º—É"',
            '"—á–æ–º—É —Ç–∞–∫ –≤–∞–∂–∫–æ –ø—Ä–∏–π–Ω—è—Ç–∏ —â–æ"',
            '"—è –¥—É–º–∞–≤ —â–æ –∑ –≤—ñ–∫–æ–º —Å—Ç–∞–Ω–µ –ª–µ–≥—à–µ"',
            '"—ñ–Ω–æ–¥—ñ –Ω–∞–π—á–µ—Å–Ω—ñ—à–µ —Ü–µ –ø—Ä–æ—Å—Ç–æ"',
            '"–º–æ–∂–ª–∏–≤–æ —è –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑—Ä–æ–∑—É–º—ñ—é —á–æ–º—É"',
            '"–∫–æ–∂–µ–Ω –Ω–æ–≤–∏–π –¥–µ–Ω—å —Ü–µ —à–∞–Ω—Å"',
            '"—è –Ω–µ –∑–Ω–∞—é —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–ª–µ"',
            '"–∑–¥–∞—î—Ç—å—Å—è –≤—Å—ñ —Ü—ñ —Ä–æ–∫–∏ —è"',
            '"–º–æ–∂–ª–∏–≤–æ –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–µ –≤–∏–∑–Ω–∞—Ç–∏ —â–æ"',
            '"—á–æ–º—É –Ω—ñ—Ö—Ç–æ –Ω–µ –∫–∞–∂–µ –ø—Ä–æ —Ç–µ —â–æ"',
            '"—è —Ö–æ—Ç—ñ–≤ –±–∏ –ø–æ–≤—ñ—Ä–∏—Ç–∏ —â–æ –∫–æ–ª–∏—Å—å"',
            '"—ñ–Ω–æ–¥—ñ —î–¥–∏–Ω–µ —â–æ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Ü–µ"',
            '"–º–æ–∂–ª–∏–≤–æ —Å–ø—Ä–∞–≤–∂–Ω—è —Å–∏–ª–∞ —É —Ç–æ–º—É —â–æ–±"',
            '"—è –±–æ—é—Å—å —â–æ –∑–∞–±—É–¥—É —è–∫"',
            '"—á–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —â–æ —ñ–Ω–æ–¥—ñ —è"',
            '"–∑–¥–∞—î—Ç—å—Å—è –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à—ñ —Ä–µ—á—ñ"',
            '"–º–æ–∂–ª–∏–≤–æ —è –Ω—ñ–∫–æ–ª–∏ –Ω–µ —Å—Ç–∞–Ω—É —Ç–∏–º —Ö—Ç–æ"',
            '"–∫–æ–∂–µ–Ω —Ä–∞–∑ –∫–æ–ª–∏ —è –∑–∞–∫—Ä–∏–≤–∞—é –æ—á—ñ"',
            '"—è –Ω–µ —Ä–æ–∑—É–º—ñ—é —á–æ–º—É –º–µ–Ω—ñ —Ç–∞–∫ –≤–∞–∂–∫–æ"',
            '"—ñ–Ω–æ–¥—ñ –Ω–∞–π–≥—ñ—Ä—à–µ —Ü–µ —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ"',
            '"–º–æ–∂–ª–∏–≤–æ –≤—Å–µ —â–æ –º–µ–Ω—ñ —Ç—Ä–µ–±–∞ —Ü–µ"',
            '"—á–æ–º—É —è –¥–æ—Å—ñ –Ω–µ –º–æ–∂—É"',
            '"—è –¥—É–º–∞–≤ —â–æ –∑–Ω–∞—é –∞–ª–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ"',
        ];

        let thoughts = [...initialThoughts];
        let currentIndex = 0;
        const stack = document.getElementById('stickyStack');
        const counter = document.getElementById('counter');
        const message = document.getElementById('message');
        const input = document.getElementById('thoughtInput');
        const submitBtn = document.getElementById('submitBtn');

        async function loadThoughtsFromFirebase() {
            try {
                const q = query(collection(db, 'thoughts'), orderBy('timestamp', 'desc'), limit(20));
                const querySnapshot = await getDocs(q);
                querySnapshot.forEach((doc) => {
                    const thought = doc.data().text;
                    if (!thoughts.includes(thought)) {
                        thoughts.push(thought);
                    }
                });
            } catch (error) {
                console.log('Firebase unavailable, using local data');
            }
        }

        function createStickies() {
            stack.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                const index = (currentIndex + i) % thoughts.length;
                const sticky = document.createElement('div');
                sticky.className = 'sticky-note';
                sticky.innerHTML = `<div class="sticky-text">${thoughts[index]}</div>`;
                if (i === 0) sticky.addEventListener('click', peelSticky);
                stack.appendChild(sticky);
            }
            updateCounter();
        }

        function peelSticky() {
            const topSticky = stack.querySelector('.sticky-note:first-child');
            if (!topSticky || topSticky.classList.contains('peeling-right') || 
                topSticky.classList.contains('peeling-left') || 
                topSticky.classList.contains('peeling-up')) return;
            
            const directions = ['peeling-right', 'peeling-left', 'peeling-up'];
            const randomDirection = directions[Math.floor(Math.random() * directions.length)];
            
            playPeelSound();
            topSticky.classList.add(randomDirection);
            topSticky.style.pointerEvents = 'none';
            
            setTimeout(() => {
                currentIndex = (currentIndex + 1) % thoughts.length;
                createStickies();
            }, 1200);
        }

        function playPeelSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const bufferSize = audioContext.sampleRate * 0.15;
                const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    const envelope = Math.exp(-i / (bufferSize * 0.3));
                    data[i] = (Math.random() * 2 - 1) * envelope * 0.15;
                }
                
                const source = audioContext.createBufferSource();
                source.buffer = buffer;
                const filter = audioContext.createBiquadFilter();
                filter.type = 'bandpass';
                filter.frequency.value = 2000;
                filter.Q.value = 1;
                const gainNode = audioContext.createGain();
                gainNode.gain.value = 0.3;
                
                source.connect(filter);
                filter.connect(gainNode);
                gainNode.connect(audioContext.destination);
                source.start();
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function autoPeel() {
            peelSticky();
        }

        let autoPeelInterval = setInterval(autoPeel, 15000);

        function updateCounter() {
            counter.textContent = `${currentIndex + 1} / ${thoughts.length}`;
        }

        function isSpam(text) {
            const spamPatterns = [
                /https?:\/\//i,
                /www\./i,
                /@[\w]+/i,
                /\b(–∫—É–ø–∏—Ç–∏|buy|sale|discount|viagra)\b/i,
                /((.)\2{4,})/i
            ];
            return spamPatterns.some(pattern => pattern.test(text));
        }

        submitBtn.addEventListener('click', async () => {
            const thought = input.value.trim();

            if (thought.length < 5) {
                showMessage('–î—É–º–∫–∞ –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∞...');
                return;
            }

            if (thought.length > 300) {
                showMessage('–î—É–º–∫–∞ –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥–∞...');
                return;
            }

            if (isSpam(thought)) {
                showMessage('–°—Ö–æ–∂–µ –Ω–∞ —Å–ø–∞–º. –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω–∞–∫—à–µ.');
                return;
            }

            submitBtn.disabled = true;

            try {
                await addDoc(collection(db, 'thoughts'), {
                    text: `"${thought}"`,
                    timestamp: new Date()
                });
                thoughts.push(`"${thought}"`);
                input.value = '';
                showMessage('–í–∞—à—É –¥—É–º–∫—É –¥–æ–¥–∞–Ω–æ –¥–æ —Å—Ç–æ–ø–∫–∏ —Å—Ç—ñ–∫–µ—Ä—ñ–≤!');
            } catch (error) {
                thoughts.push(`"${thought}"`);
                input.value = '';
                showMessage('–í–∞—à—É –¥—É–º–∫—É –¥–æ–¥–∞–Ω–æ –¥–æ —Å—Ç–æ–ø–∫–∏ —Å—Ç—ñ–∫–µ—Ä—ñ–≤!');
            }

            submitBtn.disabled = false;
            clearInterval(autoPeelInterval);
            autoPeelInterval = setInterval(autoPeel, 15000);
        });

        function showMessage(text) {
            message.textContent = text;
            message.classList.add('visible');
            setTimeout(() => message.classList.remove('visible'), 3000);
        }

        document.addEventListener('keydown', (e) => {
            if ((e.key === ' ' || e.key === 'Enter') && document.activeElement !== input) {
                e.preventDefault();
                peelSticky();
                clearInterval(autoPeelInterval);
                autoPeelInterval = setInterval(autoPeel, 15000);
            }
        });

        loadThoughtsFromFirebase().then(() => {
            createStickies();
        });
    </script>
</body>
</html>